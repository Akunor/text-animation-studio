# Letter Templates - All letters are 8 lines high
# ========== UPPERCASE LETTERS ==========

A = r"""
  ___  
 / _ \ 
| |_| |
| ___ | 
| | | |
|_| |_|
       
"""

B = r"""
 ____  
|  _ \ 
| |_) |
|  _ < 
| |_) |
|____/ 
       
"""

C = r"""
  ____ 
 / ___| 
| |    
| |     
| |___  
 \____| 
        
"""

D = r"""
 ____  
|  _ \ 
| | | |
| | | |
| |_| |
|____/ 
        
"""

E = r"""
 _____ 
| ____|
| |_   
|  _|  
| |___ 
|_____|
       
"""

F = r"""
 _____ 
| ____|
| |_   
|  _|  
| |    
|_|    
       
"""

G = r"""
  _____ 
 / ____| 
| |  __  
| | |_ | 
| |__| |
 \_____| 
        
"""

H = r"""
 _   _ 
| | | |
| |_| |
|  _  |
| | | |
|_| |_|
       
"""

I = r"""
 _____ 
|_   _|
  | |  
  | |  
 _| |_ 
|_____|
       
"""

J = r"""
     _ 
    | |
    | |
 _  | |
| |_| |
 \___/ 
       
"""

K = r"""
 _  __
| |/ /
| ' / 
|  <  
| . \ 
|_|\_\
      
"""

L = r"""
 _     
| |    
| |    
| |    
| |___  
|_____|
       
"""

M = r"""
 __  __  
|  \/  |
| |\/| |
| |  | |
| |  | |
|_|  |_|
        
"""

N = r"""
 _   _ 
| \ | |
|  \| |
| |\  |
| | \ |
|_| |_|
       
"""

O = r"""
  ___  
 / _ \ 
| | | |
| | | |
| |_| |
 \___/ 
        
"""

P = r"""
 ____  
|  _ \ 
| |_) |
|  __/ 
| |    
|_|    
       
"""

Q = r"""
  ___  
 / _ \ 
| | | |
| | | |
| |_| |
 \__\_\
       
"""

R = r"""
 ____  
|  _ \ 
| |_) |
|  _ < 
| | | |
|_| |_|
       
"""

S = r"""
  _____ 
 / ____|
| (___  
 \___ \ 
 ____) |
|_____/  
        
"""

T = r"""
 _____ 
|_   _|
  | |  
  | |  
  | |  
  |_|  
       
"""

U = r"""
 _   _ 
| | | |
| | | |
| | | |
| |_| |
 \___/ 
        
"""

V = r"""
__       __
\ \     / /
 \ \   / / 
  \ \ / /  
   \ V /   
    \_/    
           
"""

W = r"""
__          __
\ \        / /
 \ \  /\  / / 
  \ \/  \/ /  
   \  /\  /   
    \/  \/    
              
"""

X = r"""
 __  __ 
 \ \/ / 
  \  /  
  /  \  
 / /\ \ 
/_/  \_\
        
"""

Y = r"""
__   __
\ \ / /
 \ V / 
  | |  
  | |   
  |_|   
        
"""

Z = r"""
 ______ 
|___  / 
   / /  
  / /   
 / /___ 
/______|
"""

# ========== LOWERCASE LETTERS ==========

a = r""" 
       
       
  __ _   
 / _` | 
| (_| |
 \__,_|
        
"""

b = r"""
 _     
| |    
| |__  
| '_ \ 
| |_) |
|_.__/ 
       
"""

c = r"""
       
       
  ____  
 / ___| 
| |___  
 \____| 
        
"""

d = r"""
     _ 
    | |
  __| |
 / _` |
| (_| |
 \__,_|
       
"""

e = r"""
      
      
  ___  
 / _ \ 
|  __/ 
 \___| 
        
"""

f = r"""
    ___ 
   / __| 
 _| |_  
|_   _| 
  | |   
  |_|   
        
"""

g = r"""
        
        
  ___  
 / _ \ 
| (_) |
 \__, |
 \___/  
"""

h = r"""
 _     
| |    
| |__  
|  _ \ 
| | | |
|_| |_|
       
"""

i = r"""
   
 _ 
(_)
 _ 
| |
|_|
   
"""

j = r"""
     
   _ 
  (_)
   _ 
  | |
 _| |
\__/ 
"""

k = r"""
      
 _    
| |__ 
| / / 
| | \ 
|_|\_\
      
"""

l = r"""
 _ 
| |
| |
| |
| |
|_|
   
"""

m = r"""
                
           
 _ __ ___  
| '_ V _ \ 
| | | | | |
|_| |_| |_|
           
"""

n = r"""
       
       
 _ __  
| '_ \ 
| | | |
|_| |_|
        
"""

o = r"""
        
       
  ___  
 / _ \ 
| (_) |
 \___/ 
        
"""

p = r"""
        

 _ __  
| '_ \ 
| |_) |
| .__/ 
|_|      
"""

q = r"""


  ___   
 / _ \  
| (_) | 
 \__, |_
    \__/
"""

r = r"""
      
      
 _ __  
| '__| 
| |    
|_|    
        
"""

s = r"""
   
        
 ____  
/ ___| 
\___ \ 
|____/ 
      
"""

t = r"""
 _   
| |  
| |_ 
| __|
| |_ 
 \__|
     
"""

u = r"""
          
       
 _   _ 
| | | |
| |_| |
 \__,_|
        
"""

v = r"""
        
       
__   __
\ \ / /
 \ V /  
  \_/   
        
"""

w = r"""
          
          
__      __
\ \ /\ / / 
 \ V  V /  
  \_/\_/   
           
"""

x = r"""
      
      
__  __
\ \/ / 
 /  \ 
/_/\_\
      
"""

y = r"""
       
       
__   __
\ \ / /
 \ V /  
 _| |   
 \__|    
"""

z = r"""
        
       
 _____ 
|__  / 
  / /_ 
 /____|
       
"""

# ========== NUMBERS ==========

num0 = r"""
       
  ___  
 / _ \ 
| | | |
| |_| |
 \___/ 
        
"""

num1 = r"""
 __ 
/_ |
 | |
 | |
 | |
 |_|
    
"""

num2 = r"""
 ___    
|__ \ 
   ) |
  / / 
 / /_ 
|____|
      
"""

num3 = r"""
 ____   
|___ \ 
  __) |
 |__ < 
 ___) |
|____/ 
       
"""

num4 = r"""
 _  _   
| || |  
| || |_ 
|__   _|
   | |  
   |_|  
        
"""

num5 = r"""
 _____ 
| ____|
| |__  
|___ \ 
 ___) |
|____/ 
       
"""

num6 = r"""
   __  
  / /  
 / /_  
| '_ \ 
| (_) |
 \___/ 
       
"""

num7 = r"""
 ______  
|____  |
    / /  
   / /   
  / /    
 /_/     
        
"""

num8 = r"""
  ___  
 / _ \ 
| (_) |
>  _  <
| (_) |
 \___/ 
       
"""

num9 = r"""
  ___  
 / _ \ 
| (_) |
 \__, |
   / / 
  /_/  
       
"""

# ========== PUNCTUATION ==========

exclamation = r"""
 
|
|
|
|
O
 
"""

question = r"""
  ___  
 / _ \ 
|_/ \ \
    /_/ 
    _     
   |_| 
        
"""

period = r"""
      
      
      
      
  _   
 (_)  
      
"""

comma = r"""
     
     
     
     
  _  
 / | 
|_/  
"""

apostrophe = r"""
 _ 
| |
|_|
   
   
   

"""

colon = r"""
     
     
  _  
 (_) 
  _  
 (_) 
    
"""

semicolon = r"""
      
  _   
 (_)  
  _   
 / |  
|_/   

"""

hyphen = r"""
       
       
       
 _____ 
|_____|
       
       
"""

underscore = r"""
        
        
        
        
        
        
________
"""

space = r"""
        
        
        
        
        
        
        
"""

def combine_letters(text, spacing=1):
    """
    Combine multiple letters into a single ASCII art string.
    
    Each letter is exactly 7 lines tall, with varying widths.
    Whitespace is preserved for proper alignment.
    
    Args:
        text: String to convert (e.g., "HI!", "SAM")
        spacing: Number of spaces between letters (default: 1)
    
    Returns:
        Combined ASCII art string
    """
    # Map characters to variables
    char_map = {
        'A': A, 'B': B, 'C': C, 'D': D, 'E': E, 'F': F, 'G': G, 'H': H,
        'I': I, 'J': J, 'K': K, 'L': L, 'M': M, 'N': N, 'O': O, 'P': P,
        'Q': Q, 'R': R, 'S': S, 'T': T, 'U': U, 'V': V, 'W': W, 'X': X,
        'Y': Y, 'Z': Z,
        'a': a, 'b': b, 'c': c, 'd': d, 'e': e, 'f': f, 'g': g, 'h': h,
        'i': i, 'j': j, 'k': k, 'l': l, 'm': m, 'n': n, 'o': o, 'p': p,
        'q': q, 'r': r, 's': s, 't': t, 'u': u, 'v': v, 'w': w, 'x': x,
        'y': y, 'z': z,
        '0': num0, '1': num1, '2': num2, '3': num3, '4': num4, '5': num5,
        '6': num6, '7': num7, '8': num8, '9': num9,
        '!': exclamation, '?': question, '.': period, ',': comma,
        "'": apostrophe, ':': colon, ';': semicolon, '-': hyphen,
        '_': underscore, ' ': space
    }
    
    # Split each letter into lines (preserving alignment whitespace)
    letter_lines = []
    for char in text:
        if char in char_map:
            letter = char_map[char]
            lines = letter.split('\n')
            if lines and not lines[-1].strip():
                lines.pop()
            while len(lines) < 8:
                lines.append("")
            lines = lines[:8]
            
            # Find max and then normalise line widths

            max_content_width = 0
            for line in lines:
                if line.strip():
                    max_content_width = max(max_content_width, len(line))
            if max_content_width == 0:
                max_content_width = max(len(line) for line in lines) if lines else 0
            
            normalized_lines = []
            for line in lines:
                if not line.strip() and len(line) > max_content_width:
                    # Trim excessive whitespace from whitespace-only lines
                    line = line[:max_content_width] if max_content_width > 0 else ""
                normalized_lines.append(line.ljust(max_content_width))
            
            letter_lines.append(normalized_lines)
        else:
            # Unknown character - uses space
            lines = space.split('\n')
            if lines and not lines[-1].strip():
                lines.pop()
            while len(lines) < 8:
                lines.append("")
            lines = lines[:8]

            # Same normalisation as above

            max_content_width = 0
            for line in lines:
                if line.strip():
                    max_content_width = max(max_content_width, len(line))
            
            if max_content_width == 0:
                max_content_width = max(len(line) for line in lines) if lines else 0
            
            normalized_lines = []
            for line in lines:
                if not line.strip() and len(line) > max_content_width:
                    line = line[:max_content_width] if max_content_width > 0 else ""
                normalized_lines.append(line.ljust(max_content_width))
            
            letter_lines.append(normalized_lines)
    
    if not letter_lines:
        return ""

    num_lines = 8
    combined_lines = []
    
    # Combine letters horizontally line by line
    for line_idx in range(num_lines):
        line_parts = []
        for letter in letter_lines:
            if line_idx < len(letter):
                # Preserve alignemnt whitespace
                line_parts.append(letter[line_idx])
            else:
                line_parts.append("")
                
        combined_line = (' ' * spacing).join(line_parts)
        combined_lines.append(combined_line)
    
    # Join all lines and add trailing newline
    return '\n'.join(combined_lines) + '\n'